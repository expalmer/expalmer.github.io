<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
    
    <title>Criando seu proprio Array Reduce em Javascript | Palmer Oliveira. Juntos Aprendemos Mais!</title>
    

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="white" />

    <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/rss.xml">

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />

    <meta name="author" content="@expalmer">
    <meta name="description" content="Aprendendo programação funcional criando um reduce em javascript.">
    <link rel="canonical" href="http://expalmer.github.io/criando-seu-proprio-array-reduce-em-javascript">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@expalmer">
    <meta name="twitter:domain" content="http://expalmer.github.io">
    <meta name="twitter:image:src" content="http://expalmer.github.io/images/palmer.jpg">
    <meta name="twitter:creator" content="@expalmer">
    <meta name="twitter:title" content="Criando seu proprio Array Reduce em Javascript">
    <meta name="twitter:description" content="Aprendendo programação funcional criando um reduce em javascript.">

    <meta itemprop="name" content="Criando seu proprio Array Reduce em Javascript">
    <meta itemprop="description" content="Aprendendo programação funcional criando um reduce em javascript.">
    <meta itemprop="image" content="http://expalmer.github.io/images/palmer.jpg">
    <meta itemprop="url" content="http://expalmer.github.io/criando-seu-proprio-array-reduce-em-javascript">
    <meta itemprop="author" content="@expalmer">
    <meta itemprop="inLanguage" content="pt-BR">
    <meta itemprop="keywords" content="javascript">

    <meta property="og:locale" content="pt_BR">
    <meta property="og:type" content="article">
    <meta property="og:image" content="http://expalmer.github.io/images/palmer.jpg">
    <meta property="og:title" content="Criando seu proprio Array Reduce em Javascript">
    <meta property="og:description" content="Aprendendo programação funcional criando um reduce em javascript.">
    <meta property="og:url" content="http://expalmer.github.io/criando-seu-proprio-array-reduce-em-javascript">
    <meta property="og:site_name" content="Criando seu proprio Array Reduce em Javascript">

    <meta name="google-site-verification" content="BkRIiZn31VGZWd4NBpMhpA8pxdgnSOVwB0jaCFP800M" />

    <link rel="stylesheet" href="/styles/main.min.css">

    <link href="/favico.ico" rel="icon">

  </head>
  <body>
    <header class="header">
      <a href="http://expalmer.github.io" class="header__home" title="Blog do expalmer">
        <figure>
          <img src="http://expalmer.github.io/images/palmer.jpg" alt="Foto de um Panda de Óculos">
        </figure>
        <p>@expalmer</p>
      </a>
      <h1>A Javascript Enthusiast</h1>
      <h2>Juntos Aprendemos Mais :)</h2>
      <nav class="header__menu">
        <ul class="menu">
          <li><a href="http://expalmer.github.io" class="menu__link" title="Posts do Blog">Posts</a></li>
          <li><a href="http://expalmer.github.io/tags/" class="menu__link" title="Tags do Blog">Tags</a></li>
          <li><a href="https://github.com/expalmer" class="menu__link" title="Github do @expalmer">GitHub</a></li>
          <li><a href="http://expalmer.github.io/rss.xml" class="menu__link" title="RSS do Blog">RSS</a></li>
        </ul>
      </nav>
    </header>

    
  <main class="main">
    <div class="limiter">
      <article class="article" itemscope itemtype="https://schema.org/Blog">
        <header>
          <time class="post__time" itemprop="datePublished" content="December 21, 2015" datetime="December 21, 2015">December 21, 2015</time>
          <h1 class="post__title">Criando seu proprio Array Reduce em Javascript</h1>
          <iside class="post__related">
            
            <a href="http://expalmer.github.io/tags/javascript" class="atag javascript" title="Veja mais posts sobre javascript">javascript</a>
            
          </iside>
        </header>
        <p>Reduce é uma função simples, porém muito poderosa, e se você tiver criatividade poderá fazer coisas incríveis com ela.</p>
<h2 id="reduce-">Reduce ?</h2>
<p>É um padrão onde você percorre uma coleção e faz reduções na mesma. Simples assim.</p>
<p>No reduce você passa uma função que será executada a cada item ( como o <code>map</code> ), mas com o detalhe de que sua função será executada com 4 argumentos:</p>
<ul>
<li>1 - <strong>Acumulador</strong>: O 1º item do array, ou um valor inicial (2º parâmetro do reduce)</li>
<li>2 - <strong>Item Atual</strong>: 2º item ou o 1º se houver valor inicial</li>
<li>3 - <strong>Indice</strong>: Indice atual</li>
<li>4 - <strong>Array</strong>: Array inteiro</li>
</ul>
<p>Ou seja, na primeira execução de cara você já recebe o primeiro e o segundo item de sua coleção, o que você retornar será o acumulador na próxima chamada. Também é possível passar um segundo argumento no reduce, caso queira um valor inicial, e com isso é possível fazer muitas coisas.</p>
<p>Para melhor entendimento, dê uma olhada na <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce">documentação da Mozzila</a>.</p>
<p>Vamos já criar nosso próprio <code>reduce</code>, e na sequencia já temos alguns exemplos onde ficará mais claro do que estamos falando.</p>
<h2 id="reduce">reduce</h2>
<pre><code class="lang-javascript">Array.prototype.reduce = function(callback, initialValue) {
  var len = this.length;
  var index = 1; // index começa em 1
  var accumulatedValue = this[0]; // valor acumulado é o 1o valor
  // se for passado valor inicial, mudamos as coisas
  if ( initialValue ) {
    index = 0; // começa em 0
    accumulatedValue = initialValue; // acumulado = valor inicial
  }
  while(index &lt; len) {
    accumulatedValue = callback(accumulatedValue, this[index], index, this );
    index++;
  }
  return accumulatedValue;
};
</code></pre>
<h2 id="exemplos-pr-ticos">Exemplos Práticos</h2>
<p>Vou usar sempre as variáveis com nomes <code>acc</code> de accumulator (acumulador), e <code>curr</code> de currentValue (valor atual ou valor corrente).</p>
<h3 id="somando">Somando</h3>
<p>Somamos todos os items de uma array.</p>
<pre><code class="lang-javascript">var total = [1,2,3,4,5,6,7,8]
  .reduce(function( acc, curr ) {
    return acc + curr;
  });

console.log(total);
// 36
</code></pre>
<h3 id="multiplicando">Multiplicando</h3>
<p>Multiplicamos todos os items de uma array.</p>
<pre><code class="lang-javascript">var total = [1,2,3,4]
  .reduce(function( acc, curr ) {
    return acc * curr;
  });

console.log(total);
// 24
</code></pre>
<h3 id="maior-e-menor-valor">Maior e Menor valor</h3>
<p>Agora algo mais interessante, quem é o maior valor no array?</p>
<pre><code class="lang-javascript">var maior = [1,2,99,4,5]
  .reduce(function( acc, curr ) {
    return acc &gt; curr ? acc : curr;
  });

console.log(maior);
// 99
</code></pre>
<p>Para verificar o menor valor, troque o operador para <code>&lt;</code>.</p>
<h3 id="and-e-or">AND e OR</h3>
<p>Vamos criar uma função <code>AND</code>, que verifica se dentro do array todos os valores são verdadeiros, ou seja, sejam diferentes de <code>&quot;&quot;</code>, <code>0</code>, <code>undefined</code> e <code>false</code>. Perceba que passo um valor inicial para <strong>reduce</strong> contendo <code>true</code>.</p>
<pre><code class="lang-javascript">var ok = [1,2,3,4,&#39;ola&#39;,true]
  .reduce(function( acc, curr ) {
    return !!(acc &amp;&amp; curr);
  }, true);

console.log(ok);
// true

var ops = [1,2,3,null,&#39;ola&#39;]
  .reduce(function( acc, curr ) {
    return !!(acc &amp;&amp; curr);
  }, true);

console.log(ops);
// false. pois tem um null
</code></pre>
<p>Vamos criar agora o <code>OR</code>, dessa vez passo o valor inicial de <code>false</code> para fazer a verificação. Se houver qualquer valor verdadeiro no array, retorna <code>true</code>.</p>
<pre><code class="lang-javascript">var ok = [false,&#39;&#39;,null,&#39;Ola&#39;]
  .reduce(function( acc, curr ) {
    return !!(acc || curr);
  }, false);

console.log(ok);
// true

var ops = [false,&#39;&#39;,null,&#39;&#39;]
  .reduce(function( acc, curr ) {
    return !!(acc || curr);
  }, false);

console.log(ops);
// false. pois não tem nenhum valor verdadeiro
</code></pre>
<h3 id="inverter-um-array">Inverter um array</h3>
<p>Claro que você vai preferir usar a função <code>reverse</code>, mas saca só que interessante usar <strong>reduce</strong> para isso.</p>
<pre><code class="lang-javascript">var rev = [&#39;s&#39;,&#39;t&#39;,&#39;a&#39;,&#39;r&#39;,&#39;&#39;,&#39;w&#39;,&#39;a&#39;,&#39;r&#39;,&#39;s&#39;]
  .reduce(function( acc, curr, index ) {
    return [curr].concat(acc);
  },[]);

console.log(rev);
// [ &#39;s&#39;, &#39;r&#39;, &#39;a&#39;, &#39;w&#39;, &#39;&#39;, &#39;r&#39;, &#39;a&#39;, &#39;t&#39;, &#39;s&#39; ]
</code></pre>
<p>Mas eu te digo, você vai precisar fazer algo do tipo um dia!</p>
<h3 id="inverter-um-array-com-condi-o">Inverter um array com condição</h3>
<p>O que acha de inverter o array, mas somente os items que forem consoantes?</p>
<pre><code class="lang-javascript">
var cons = [&#39;s&#39;,&#39;t&#39;,&#39;a&#39;,&#39;r&#39;,&#39;&#39;,&#39;w&#39;,&#39;a&#39;,&#39;r&#39;,&#39;s&#39;]
  .reduce(function( acc, curr, index ) {
    return curr.match(/[^aeiou]/) ? [curr].concat(acc) : acc;
  },[]);

console.log(cons);
// [ &#39;s&#39;, &#39;r&#39;, &#39;w&#39;, &#39;r&#39;, &#39;t&#39;, &#39;s&#39; ]
</code></pre>
<h3 id="exemplo-com-objetos">Exemplo com objetos</h3>
<p>Vamos usar nossos dados <strong>lordOfTheRings</strong> para fazer mais alguns exemplos.</p>
<pre><code class="lang-javascript">var lordOfTheRings = [
  { name: &quot;Galadriel&quot;, race: &quot;Elves&quot;, weapons: [ &quot;Elven Magic&quot;, &quot;Nenya&quot; ] },
  { name: &quot;Legolas&quot;,   race: &quot;Elves&quot;, weapons: [ &quot;Bow&quot;, &quot;Knife&quot; ] },
  { name: &quot;Gandalf&quot;,   race: &quot;Maiar&quot;, weapons: [ &quot;Glamdring&quot;, &quot;Wizard Staff&quot;, &quot;Sword&quot; ] },
  { name: &quot;Radagast&quot;,  race: &quot;Maiar&quot;, weapons: [ &quot;Powers of the Maiar&quot;, &quot;Wizard Staff&quot; ] },
  { name: &quot;Aragorn&quot;,   race: &quot;Men&quot;,   weapons: [ &quot;Anduril&quot;, &quot;Sword&quot; ] },
  { name: &quot;Sauron&quot;,    race: &quot;Ainur&quot;, weapons: [ &quot;One Ring&quot;, &quot;Sword&quot;, &quot;Powers of the Maiar&quot; ] },
  { name: &quot;Faramir&quot;,   race: &quot;Men&quot;,   weapons: [ &quot;Bow&quot;, &quot;Sword&quot; ] }
];
</code></pre>
<h3 id="maior-n-mero-de-caracteres-nas-weapons">Maior número de caracteres nas Weapons</h3>
<p>Eu quero que retorne apenas o nome de quem tem o maior número de caracteres em suas <strong>weapons</strong>, olha que interessante:</p>
<pre><code class="lang-javascript">var name = lordOfTheRings
  .reduce(function( a, b, index, array) {
    var acc = a.weapons.join(&#39;&#39;).length &gt; b.weapons.join(&#39;&#39;).length ? a : b;
    if( array.length -1 === index ) {
      acc = acc.name;
    }
    return acc;
  })

console.log(name);
// Sauron
</code></pre>
<p>Note que faço um <strong>if</strong> para verificar o último item do laço, para transformá-lo em uma única string.</p>
<h3 id="agrupar-por-ra-a">Agrupar por raça</h3>
<p>Agora um exemplo mais complexo, onde quero agrupar os nomes por raça:</p>
<pre><code class="lang-javascript">var lordOfTheRings = [
  { name: &quot;Galadriel&quot;, race: &quot;Elves&quot;, weapons: [ &quot;Elven Magic&quot;, &quot;Nenya&quot; ] },
  { name: &quot;Legolas&quot;,   race: &quot;Elves&quot;, weapons: [ &quot;Bow&quot;, &quot;Knife&quot; ] },
  { name: &quot;Gandalf&quot;,   race: &quot;Maiar&quot;, weapons: [ &quot;Glamdring&quot;, &quot;Wizard Staff&quot;, &quot;Sword&quot; ] },
  { name: &quot;Radagast&quot;,  race: &quot;Maiar&quot;, weapons: [ &quot;Powers of the Maiar&quot;, &quot;Wizard Staff&quot; ] },
  { name: &quot;Aragorn&quot;,   race: &quot;Men&quot;,   weapons: [ &quot;Anduril&quot;, &quot;Sword&quot; ] },
  { name: &quot;Sauron&quot;,    race: &quot;Ainur&quot;, weapons: [ &quot;One Ring&quot;, &quot;Sword&quot;, &quot;Powers of the Maiar&quot; ] },
  { name: &quot;Faramir&quot;,   race: &quot;Men&quot;,   weapons: [ &quot;Bow&quot;, &quot;Sword&quot; ] }
];
var byRace = lordOfTheRings
  .reduce(function( acc, curr) {
    acc[curr.race] = acc[curr.race] || [];
    acc[curr.race].push(curr.name);
    return acc;
  },{});

console.log(byRace);
/*
{
 Elves: [ &#39;Galadriel&#39;, &#39;Legolas&#39; ],
 Maiar: [ &#39;Gandalf&#39;, &#39;Radagast&#39; ],
 Men: [ &#39;Aragorn&#39;, &#39;Faramir&#39; ],
 Ainur: [ &#39;Sauron&#39; ]
}
*/
</code></pre>
<h2 id="implementa-es">Implementações</h2>
<p>Reduce é sem dúvida uma das funções que mais gosto de usar, pois com ela podemos fazer muitas coisas, inclusive implementar nossas funções arrays:</p>
<h3 id="foreach">forEach</h3>
<pre><code class="lang-javascript">Array.prototype.forEach = function(callback) {
  return this.reduce( function( acc, x ) {
    callback(x);
    return x;
  },null);
};
</code></pre>
<h3 id="map">map</h3>
<pre><code class="lang-javascript">Array.prototype.map = function( callback ) {
 return this.reduce( function( acc, x ) {
    return acc.concat( callback(x) );
  },[]);
};
</code></pre>
<h3 id="filter">filter</h3>
<pre><code class="lang-javascript">Array.prototype.filter = function(callback) {
  return this.reduce( function( acc, x ) {
    return callback(x) ? acc.concat( x ) : acc;
  },[]);
};
</code></pre>
<h2 id="concluindo">Concluindo</h2>
<p>Eu particularmente tenho usado reduce em vários projetos, pode até não parecer, mas você pode usar reduce em praticamente tudo.</p>
<p>Aprendemos mais uma função útil, logo iremos usar todas elas juntas, encadeando funções onde a coisa se torna super interessante.</p>
<p>No próximo post vamos implementar o <strong>mergeAll</strong> e ver para que ele serve.</p>
<p>Espero que tenham gostado. That&#39;s it !</p>

      </article>
      <!-- COMMENTS -->
      <section id="comments">
        <div id="disqus_thread"></div>
        <script data-cfasync="true" type="text/javascript">
            var disqus_shortname = 'expalmer';
            var disqus_url = 'http://expalmer.github.io/criando-seu-proprio-array-reduce-em-javascript/';
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </section>
    </div>
  </main>


    <footer class="footer">
      <p>Made with <a href="http://www.metalsmith.io/" title="Metalsmith">Metalsmith</a>. View <a href="https://github.com/expalmer/expalmer.github.io-files" title="Source">Source</a></p>
    </footer>
    <script src="/scripts/main.min.js"></script>
  </body>
</html>